# # requirements.txt
# """
# flask==2.3.3
# google-generativeai==0.7.2
# requests==2.31.0
# python-dotenv==1.0.0
# """

# # Setup Instructions:
# """
# CRITICAL WEBHOOK SETUP - YEH STEP MISS HO RAHA HAI:

# 1. Install ngrok:
#    - Download from https://ngrok.com/
#    - Extract and add to PATH

# 2. Install Python packages:
#    pip install flask google-generativeai requests python-dotenv

# 3. Get Gemini API key:
#    https://makersuite.google.com/app/apikey

# 4. Run the server:
#    python app.py

# 5. In another terminal, expose with ngrok:
#    ngrok http 5000
   
# 6. Copy the https URL from ngrok (e.g., https://abc123.ngrok.io)

# 7. CRITICAL: Meta Developer Console COMPLETE setup:
   
#    A) Basic Webhook Setup:
#    - Go to developers.facebook.com
#    - Your App → WhatsApp → Configuration
#    - Webhook URL: https://abc123.ngrok.io/webhook
#    - Verify token: rafay_secret_token123
#    - Click "Verify and save"
   
#    B) MOST IMPORTANT - Webhook Subscriptions:
#    - In same Configuration page
#    - Find "Webhook fields" section
#    - Check these boxes:
#      ✅ messages
#      ✅ message_deliveries  
#      ✅ message_reads
#      ✅ message_reactions
#    - Click "Save"
   
#    C) Phone Number Setup:
#    - Go to API Setup tab
#    - Add your phone number in "To" field: +923001234567
#    - Add test number: +16315551181
#    - Save

# 8. Test Configuration:
#    - Send message from your phone to WhatsApp Business number
#    - Check ngrok terminal - should show webhook calls
#    - Check your app terminal - should show message processing

# DEBUGGING STEPS:
# 1. Check ngrok is running: http://localhost:4040 (ngrok web interface)
# 2. Test webhook manually:
#    curl -X POST https://your-ngrok-url.ngrok.io/webhook \
#    -H "Content-Type: application/json" \
#    -d '{"entry":[{"changes":[{"field":"messages","value":{"messages":[{"from":"1234567890","text":{"body":"test"},"type":"text","id":"msg123"}]}}]}]}'

# 3. Check Meta webhook logs:
#    - Meta Console → WhatsApp → Configuration → Webhook
#    - Check "Recent Deliveries" for errors

# COMMON ISSUES:
# ❌ Webhook subscriptions not enabled (most common)
# ❌ ngrok URL not updated in Meta Console  
# ❌ Verify token mismatch
# ❌ Phone number not in allowed list
# ❌ Webhook URL not https
# ❌ Gemini API key missing

# SOLUTION PRIORITY:
# 1. First: Enable webhook subscriptions (messages field)
# 2. Second: Verify ngrok URL is correct
# 3. Third: Check phone number in allowed list
# 4. Fourth: Test webhook manually
# """